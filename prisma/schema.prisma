// schema.prisma

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("user")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Project {
  id          String   @id @default(cuid())
  slug        String   @unique
  title       String
  category    String
  tags        String[]
  description String
  tech        String[]
  image       String
  challenge   String
  solution    String
  results     String[]
  gallery     String[]
  figmaDesign Json?    // { thumbnail, title, url }
  
  caseStudyData Json? // Stores the FigmaCaseStudy data structure
  caseStudies CaseStudy[]

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model CaseStudy {
  id           String   @id @default(cuid())
  project      Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  projectId    String
  
  meta         Json
  overview     Json
  architecture Json
  features     Json
  roadmap      Json
  deployment   Json?
  visuals      Json?

  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Profile {
  id             String   @id @default(cuid())
  name           String
  headline       String
  bio            String
  avatar         String?
  skills         String[]
  experiences    Json[]   // [{ title, company, period, description, logo }]
  education      Json[]   // [{ title, institution, year }]
  certifications Json[]   // [{ title, issuer, date }]
  languages      Json[]   // [{ language, proficiency }]
  contactInfo    Json?    // { email, phone, address, social }
  heroSlides     Json[]   // [{ type: 'image'|'video'|'3d', url, component, alt }]
  
  updatedAt      DateTime @updatedAt
}

model Article {
  id            String   @id @default(cuid())
  slug          String   @unique
  title         String
  content       String   @db.Text // MDX content
  excerpt       String?
  tags          String[]
  category      String   // e.g., 'Tutorial', 'Deep Dive', 'Quick Fix'
  
  techStack     Json?    // [{ name, icon, version }]
  repositoryUrl String?
  demoUrl       String?
  
  caseStudyData Json?    // Stores the FigmaCaseStudy data structure when used as a Case Study
  
  isPublished   Boolean  @default(false)
  isArchived    Boolean  @default(false)
  views         Int      @default(0)
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model DevReport {
  id            String   @id @default(cuid())
  title         String
  slug          String   @unique // e.g., "dev-report-dec-2025"
  period        String   // e.g., "December 2025"
  
  content       String   @db.Text
  
  metrics       Json?    // { commits: 120, PRs: 5, lighthouse: 98 }
  highlights    String[] // Quick bullet points
  
  isPublished   Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Service {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String
  icon        String // Lucide icon name or image url
  price       String?
  features    String[]
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
